{"ast":null,"code":"var _jsxFileName = \"D:\\\\download\\\\240825gestao\\\\gestao\\\\frontend\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\n\n// Tipos de usuário e suas permissões\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const USER_ROLES = {\n  ADMIN: 'Admin',\n  WILLIANS: 'Willians',\n  MANUTENCAO: 'Manutenção',\n  VISUALIZACAO: 'Visualização'\n};\nexport const PERMISSIONS = {\n  [USER_ROLES.ADMIN]: {\n    pages: ['*'],\n    // Acesso a todas as páginas\n    actions: ['create', 'read', 'update', 'delete']\n  },\n  [USER_ROLES.WILLIANS]: {\n    pages: ['*'],\n    // Acesso a todas as páginas\n    actions: ['create', 'read', 'update', 'delete']\n  },\n  [USER_ROLES.MANUTENCAO]: {\n    pages: ['/testes-loja-menu', '/testes-loja', '/testes-ar-condicionado'],\n    actions: ['create', 'read', 'update']\n  },\n  [USER_ROLES.VISUALIZACAO]: {\n    pages: ['/testes-loja-menu', '/testes-loja', '/testes-ar-condicionado'],\n    actions: ['read']\n  }\n};\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth deve ser usado dentro de um AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  // Verificar se há token salvo ao carregar a página\n  useEffect(() => {\n    const savedToken = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n    if (savedToken && savedUser) {\n      setToken(savedToken);\n      setUser(JSON.parse(savedUser));\n      setIsAuthenticated(true);\n    }\n    setLoading(false);\n  }, []);\n  const login = (token, userData) => {\n    setToken(token);\n    setUser(userData);\n    setIsAuthenticated(true);\n    localStorage.setItem('token', token);\n    localStorage.setItem('user', JSON.stringify(userData));\n  };\n  const logout = () => {\n    setToken(null);\n    setUser(null);\n    setIsAuthenticated(false);\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  };\n  const hasPermission = (page, action = 'read') => {\n    if (!user || !user.nivel_acesso) {\n      // Se não há usuário ou nível de acesso, permitir acesso básico para debug\n      return true;\n    }\n    const userPermissions = PERMISSIONS[user.nivel_acesso];\n    if (!userPermissions) {\n      // Se o nível de acesso não está definido nas permissões, permitir acesso\n      return true;\n    }\n\n    // Admin tem acesso a tudo\n    if (userPermissions.pages.includes('*')) return true;\n\n    // Verificar se tem permissão para a página\n    const hasPageAccess = userPermissions.pages.some(allowedPage => page.startsWith(allowedPage) || allowedPage === page);\n\n    // Verificar se tem permissão para a ação\n    const hasActionAccess = userPermissions.actions.includes(action);\n    return hasPageAccess && hasActionAccess;\n  };\n  const getUserRoleLabel = role => {\n    switch (role) {\n      case USER_ROLES.ADMIN:\n        return 'Administrador';\n      case USER_ROLES.WILLIANS:\n        return 'Willians';\n      case USER_ROLES.MANUTENCAO:\n        return 'Manutenção';\n      case USER_ROLES.VISUALIZACAO:\n        return 'Visualização';\n      default:\n        return 'Indefinido';\n    }\n  };\n  const isAdmin = () => {\n    return (user === null || user === void 0 ? void 0 : user.nivel_acesso) === USER_ROLES.ADMIN || (user === null || user === void 0 ? void 0 : user.nivel_acesso) === USER_ROLES.WILLIANS;\n  };\n  const canAccessTests = () => {\n    return hasPermission('/testes-loja-menu', 'read');\n  };\n  const value = {\n    user,\n    token,\n    isAuthenticated,\n    loading,\n    login,\n    logout,\n    hasPermission,\n    getUserRoleLabel,\n    isAdmin,\n    canAccessTests,\n    USER_ROLES\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"Ly4Z9Py1dRelWLHKuS1IdwB0JmI=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsxDEV","_jsxDEV","USER_ROLES","ADMIN","WILLIANS","MANUTENCAO","VISUALIZACAO","PERMISSIONS","pages","actions","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","token","setToken","isAuthenticated","setIsAuthenticated","loading","setLoading","savedToken","localStorage","getItem","savedUser","JSON","parse","login","userData","setItem","stringify","logout","removeItem","hasPermission","page","action","nivel_acesso","userPermissions","includes","hasPageAccess","some","allowedPage","startsWith","hasActionAccess","getUserRoleLabel","role","isAdmin","canAccessTests","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/download/240825gestao/gestao/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\n// Tipos de usuário e suas permissões\r\nexport const USER_ROLES = {\r\n  ADMIN: 'Admin',\r\n  WILLIANS: 'Willians',\r\n  MANUTENCAO: 'Manutenção',\r\n  VISUALIZACAO: 'Visualização'\r\n};\r\n\r\nexport const PERMISSIONS = {\r\n  [USER_ROLES.ADMIN]: {\r\n    pages: ['*'], // Acesso a todas as páginas\r\n    actions: ['create', 'read', 'update', 'delete']\r\n  },\r\n  [USER_ROLES.WILLIANS]: {\r\n    pages: ['*'], // Acesso a todas as páginas\r\n    actions: ['create', 'read', 'update', 'delete']\r\n  },\r\n  [USER_ROLES.MANUTENCAO]: {\r\n    pages: ['/testes-loja-menu', '/testes-loja', '/testes-ar-condicionado'],\r\n    actions: ['create', 'read', 'update']\r\n  },\r\n  [USER_ROLES.VISUALIZACAO]: {\r\n    pages: ['/testes-loja-menu', '/testes-loja', '/testes-ar-condicionado'],\r\n    actions: ['read']\r\n  }\r\n};\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth deve ser usado dentro de um AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(null);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Verificar se há token salvo ao carregar a página\r\n  useEffect(() => {\r\n    const savedToken = localStorage.getItem('token');\r\n    const savedUser = localStorage.getItem('user');\r\n\r\n    if (savedToken && savedUser) {\r\n      setToken(savedToken);\r\n      setUser(JSON.parse(savedUser));\r\n      setIsAuthenticated(true);\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  const login = (token, userData) => {\r\n    setToken(token);\r\n    setUser(userData);\r\n    setIsAuthenticated(true);\r\n    localStorage.setItem('token', token);\r\n    localStorage.setItem('user', JSON.stringify(userData));\r\n  };\r\n\r\n  const logout = () => {\r\n    setToken(null);\r\n    setUser(null);\r\n    setIsAuthenticated(false);\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n  };\r\n\r\n  const hasPermission = (page, action = 'read') => {\r\n    if (!user || !user.nivel_acesso) {\r\n      // Se não há usuário ou nível de acesso, permitir acesso básico para debug\r\n      return true;\r\n    }\r\n    \r\n    const userPermissions = PERMISSIONS[user.nivel_acesso];\r\n    if (!userPermissions) {\r\n      // Se o nível de acesso não está definido nas permissões, permitir acesso\r\n      return true;\r\n    }\r\n\r\n    // Admin tem acesso a tudo\r\n    if (userPermissions.pages.includes('*')) return true;\r\n\r\n    // Verificar se tem permissão para a página\r\n    const hasPageAccess = userPermissions.pages.some(allowedPage => \r\n      page.startsWith(allowedPage) || allowedPage === page\r\n    );\r\n\r\n    // Verificar se tem permissão para a ação\r\n    const hasActionAccess = userPermissions.actions.includes(action);\r\n\r\n    return hasPageAccess && hasActionAccess;\r\n  };\r\n\r\n  const getUserRoleLabel = (role) => {\r\n    switch (role) {\r\n      case USER_ROLES.ADMIN:\r\n        return 'Administrador';\r\n      case USER_ROLES.WILLIANS:\r\n        return 'Willians';\r\n      case USER_ROLES.MANUTENCAO:\r\n        return 'Manutenção';\r\n      case USER_ROLES.VISUALIZACAO:\r\n        return 'Visualização';\r\n      default:\r\n        return 'Indefinido';\r\n    }\r\n  };\r\n\r\n  const isAdmin = () => {\r\n    return user?.nivel_acesso === USER_ROLES.ADMIN || user?.nivel_acesso === USER_ROLES.WILLIANS;\r\n  };\r\n\r\n  const canAccessTests = () => {\r\n    return hasPermission('/testes-loja-menu', 'read');\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    token,\r\n    isAuthenticated,\r\n    loading,\r\n    login,\r\n    logout,\r\n    hasPermission,\r\n    getUserRoleLabel,\r\n    isAdmin,\r\n    canAccessTests,\r\n    USER_ROLES\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}